{% extends "base.html" %}

{% block content %}
<div class="max-w-3xl mx-auto py-10">
    <!-- Back Link -->
    <a href="/patient/dashboard" class="inline-flex items-center text-gray-400 hover:text-white mb-6 transition">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18">
            </path>
        </svg>
        Back to Dashboard
    </a>

    <!-- Result Card -->
    <div class="glass-card rounded-2xl overflow-hidden shadow-2xl">
        <div class="p-8 text-center border-b border-white/10">
            <h1 class="text-3xl font-bold text-white mb-2">Analysis Result</h1>
            <p class="text-gray-400">Prediction ID: #{{ prediction.id }} | {{ prediction.timestamp.strftime('%Y-%m-%d
                %H:%M') }}</p>
        </div>

        <div class="p-8 md:p-12 flex flex-col md:flex-row gap-10 items-center justify-center">
            <!-- Image -->
            <div class="w-64 h-64 rounded-xl overflow-hidden shadow-lg border-4 border-white/10 shrink-0">
                <img src="/{{ prediction.image_path }}" alt="Analyzed Patch" class="object-cover w-full h-full">
            </div>

            <!-- Result -->
            <div class="flex-grow w-full max-w-sm text-center md:text-left">
                <div class="mb-6">
                    <span class="text-sm font-bold text-gray-400 uppercase tracking-widest">Detected Class</span>
                    <div
                        class="text-4xl font-extrabold mt-1 {% if prediction.result_class == 1 %}text-rose-500{% else %}text-emerald-500{% endif %}">
                        {% if prediction.result_class == 1 %}
                        POSITIVE (IDC)
                        {% else %}
                        NEGATIVE
                        {% endif %}
                    </div>
                </div>

                <div class="mb-8">
                    <div class="flex justify-between text-sm font-bold text-gray-400 mb-2">
                        <span>Confidence Score</span>
                        <span>{{ (prediction.confidence * 100)|round(1) }}%</span>
                    </div>
                    <!-- Progress Bar -->
                    <div class="w-full bg-gray-700 rounded-full h-4 overflow-hidden">
                        <div class="h-full rounded-full transition-all duration-1000 ease-out {% if prediction.result_class == 1 %}bg-rose-500{% else %}bg-emerald-500{% endif %}"
                            style="width: {{ prediction.confidence * 100 }}%"></div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex flex-col gap-3">
                    <a href="/patient/report/{{ prediction.id }}" target="_blank"
                        class="btn-primary text-white text-center font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-blue-500/50 flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.707l5.414 5.414a1 1 0 01.707.707V19a2 2 0 01-2 2z">
                            </path>
                        </svg>
                        Download Report
                    </a>
                </div>
            </div>
        </div>

        <!-- Disclaimer -->
        <div class="bg-black/30 p-6 text-center">
            <p class="text-xs text-rose-300 font-medium leading-relaxed max-w-2xl mx-auto">
                âš  IMPORTANT: This result is generated by an AI model (ResNet50) for educational purposes only.
                It achieves high accuracy but is not infallible.
                This report should NOT be used for medical diagnosis, treatment planning, or clinical decision making.
                Always consult a certified pathologist.
            </p>
        </div>
    </div>
</div>
{% endblock %}