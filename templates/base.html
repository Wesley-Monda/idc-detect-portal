<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDC Detect Portal - Educational AI Tool</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body class="bg-slate-900 text-white min-h-screen flex flex-col">

    <!-- Disclaimer Banner -->
    <div class="bg-rose-600/90 text-white text-center py-2 px-4 text-sm font-bold tracking-wide shadow-lg z-50">
        âš  DISCLAIMER: This is an EDUCATIONAL TOOL ONLY. Not for medical diagnosis or clinical use.
    </div>

    <!-- Flash Message Toast -->
    <div id="flashToast"
        class="fixed top-20 right-5 z-50 transform transition-all duration-300 translate-x-full opacity-0">
        <div
            class="glass-card bg-emerald-500/20 border-emerald-500/50 text-emerald-300 px-6 py-4 rounded-lg shadow-xl flex items-center gap-3 backdrop-blur-md">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span id="flashMessage" class="font-bold"></span>
        </div>
    </div>

    <script>
        // Simple Flash Message Logic
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const msg = urlParams.get('msg');
            if (msg) {
                const toast = document.getElementById('flashToast');
                const text = document.getElementById('flashMessage');
                text.textContent = msg;
                toast.classList.remove('translate-x-full', 'opacity-0');

                // Hide after 4 seconds
                setTimeout(() => {
                    toast.classList.add('translate-x-full', 'opacity-0');
                    // Clean URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                }, 4000);
            }
        });
    </script>

    <!-- Main Wrapper -->
    <div class="flex flex-1 relative">

        {% if user %}
        <!-- Sidebar (Logged In) -->
        <aside
            class="w-64 glass border-r border-white/10 h-[calc(100vh-40px)] fixed left-0 bottom-0 overflow-y-auto z-40 flex flex-col transition-all duration-300">
            <div class="h-16 flex items-center justify-center border-b border-white/10 shrink-0">
                <span
                    class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-teal-400">
                    IDC Detect
                </span>
            </div>

            <!-- User Info -->
            <div class="p-6 border-b border-white/5 shrink-0">
                <div class="flex items-center space-x-3">
                    <div
                        class="w-10 h-10 rounded-full bg-gradient-to-tr from-blue-500 to-purple-500 flex items-center justify-center font-bold text-lg">
                        {{ user.username[0]|upper }}
                    </div>
                    <div>
                        <p class="font-bold text-sm">{{ user.username }}</p>
                        <p class="text-xs text-gray-400 capitalize">{{ user.role }}</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 py-4">
                <ul class="space-y-1 px-2">
                    {% if user.role == 'patient' %}
                    <!-- Patient Menu -->
                    <li>
                        <a href="/patient/dashboard"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                                </path>
                            </svg>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="/patient/dashboard"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
                                </path>
                            </svg>
                            Upload Image
                        </a>
                    </li>
                    <li>
                        <a href="/patient/dashboard"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                </path>
                            </svg>
                            My Results
                        </a>
                    </li>
                    {% elif user.role == 'pathologist' %}
                    <!-- Pathologist Menu -->
                    <li>
                        <a href="/pathologist/dashboard"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4">
                                </path>
                            </svg>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="/pathologist/cases"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">
                                </path>
                            </svg>
                            Manage Cases
                        </a>
                    </li>
                    <li>
                        <a href="#"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                                </path>
                            </svg>
                            Analytics
                        </a>
                    </li>
                    {% endif %}

                    <div class="border-t border-white/10 my-2 mx-4"></div>

                    <li>
                        <a href="/profile"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-white/10 hover:text-white rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            Profile
                        </a>
                    </li>
                    <li>
                        <a href="/auth/logout"
                            class="flex items-center px-4 py-3 text-gray-300 hover:bg-red-500/20 hover:text-red-300 rounded-lg transition">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                            Logout
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>
        {% else %}
        <!-- Navbar (Guest) -->
        <nav class="glass border-b border-white/10 absolute top-0 w-full z-40">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center">
                        <span
                            class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-teal-400">
                            IDC Detect
                        </span>
                    </div>
                    <div>
                        <a href="/login"
                            class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition">Login</a>
                    </div>
                </div>
            </div>
        </nav>
        {% endif %}

        <!-- Content Area -->
        <main
            class="flex-1 transition-all duration-300 {% if user %}ml-64 p-8{% else %}mt-16 container mx-auto px-4 py-8{% endif %} fade-in">
            {% block content %}{% endblock %}
        </main>

    </div>

    {% if not user %}
    <!-- Footer (Guest only) -->
    <footer class="glass border-t border-white/10 mt-auto relative z-40">
        <div class="max-w-7xl mx-auto py-6 px-4 overflow-hidden sm:px-6 lg:px-8">
            <p class="text-center text-sm text-gray-500">
                &copy; 2024 IDC Educational Project. Powered by PyTorch & FastAPI.
            </p>
        </div>
    </footer>
    {% endif %}

</body>

</html>